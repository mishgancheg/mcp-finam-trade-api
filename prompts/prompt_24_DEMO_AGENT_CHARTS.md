**Цель:** 
Доработать demo-agent для создания интеллектуального торгового ассистента, который превращает естественный 
язык в аналитические инсайты с интерактивной визуализацией.

**Исходные сведения:**
Посмотри на предыдущее задание по внедрению визуализации
prompts/prompt_20_DEMO_AGENT_TRADING.md

Посмотри на отчет о реализации этого задания
docs/report_20_DEMO_AGENT_TRADING.md

**Что получилось и как сейччас работает:**
Не выполняет поставленную задачу по визуализации.

Просто выводит в чат длинные JSON и MARKDOWN нно ни графиков ни таблиц не рисует.

# Задача

Сделать так, чтобы в чате отображались графики и таблицы.

Начни с отображения портфеля 

Сообщи, каие к этому могут быть грайики и какая визуализация.

Какие данные нужны из каких инструментов доступных в MCP сервере?

================================================================================
Ничего не рисует. Стримингом выводит в окно чата JSON, то графиков никаких нет.

Я предлагаю сделать так:
LLM возвращает в тексте специальные вкрапления - пользовательские теги в тех местах, где нужно вставить график или
таблицу.

В этих вкраплениях передается исчерпывающая информация для формирования данных диаграммы или таблицы
вероятнее всего это имена функций построения графиков и имена функций, выдающих данные, которые можно использовать
для построения графика.
Аналогично для таблиц.

Агент находит все вкрапления, раздает им уникальные id и вызывает необходимые функции, передавая данные из
вкраплений.
Когда функция отрабатывает, она формирует весь набор данных для отрисовки диаграммы. Сохраняет в кеше со временем
жизни 10 мин с ключом раынм id.
И возвращает ссылку на получение этих данных.

Агент внедряет в текст ответа вместо вкраплений сссылки, но так же в спец-тегах, чтобы на стороне клиента
эти места находились и клиент запрашивал данные по ссылке.
По ссылке поступает спек, и вкрапление заменяется на график.
